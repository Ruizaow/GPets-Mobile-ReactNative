generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int             @id @default(autoincrement())
  role              String
  name              String
  email             String          @unique
  cnpj              String          @unique
  address           String
  password          String
  bio               String
  phone             String
  imageUrl          String?
  createdAt         DateTime        @default(now())
  
  posts             Post[]
  savedPosts        SavedPost[]

  sentMessages      Message[]       @relation("SentMessages")
  receivedMessages  Message[]       @relation("ReceivedMessages")

  notifications     Notification[]
  comments          Comment[]
}

model Post {
  id                Int             @id @default(autoincrement())
  type              String
  timestamp         String
  isOwner           Boolean
  imageUrl          String?
  name              String
  status            String
  date              String
  sex               String
  breed             String
  temper            String
  owner             String
  phone             String
  description       String
  address           String
  coordinateLat     Float
  coordinateLng     Float

  userId            Int

  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  savedBy           SavedPost[]
  comments          Comment[]
}

model SavedPost {
  id                Int             @id @default(autoincrement())

  userId            Int
  postId            Int

  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  post              Post            @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@unique([userId, postId])
}

model Message {
  id                Int             @id @default(autoincrement())
  content           String
  timestamp         String
  viewed            Boolean         @default(false)

  senderId          Int
  receiverId        Int

  sender            User            @relation("SentMessages", fields: [senderId], references: [id])
  receiver          User            @relation("ReceivedMessages", fields: [receiverId], references: [id])
}

model Notification {
  id                Int             @id @default(autoincrement())
  type              String
  title             String
  description       String
  timestamp         String
  viewed            Boolean         @default(false)

  userId            Int

  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Comment {
  id                Int             @id @default(autoincrement())
  content           String
  timestamp         String

  userId            Int
  postId            Int

  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  post              Post            @relation(fields: [postId], references: [id], onDelete: Cascade)
}